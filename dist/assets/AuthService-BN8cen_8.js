import{a as i}from"./index-DUldikvK.js";const w=()=>{const t={userAgent:navigator.userAgent,language:navigator.language,platform:navigator.platform,screenResolution:`${window.screen.width}x${window.screen.height}`},a=JSON.stringify(t);let e=0;for(let o=0;o<a.length;o++){const r=a.charCodeAt(o);e=(e<<5)-e+r,e=e&e}return`device_${Math.abs(e)}`},I=async(t,a)=>{var r,n,c,d,g,l,p,h,u;const e=w(),o="/api/auth/login";console.log(`AuthService: Intentando login para ${t} en ${o} (usando axiosInstance)`);try{const s=await i.post(o,{username:t,password:a,deviceId:e});return localStorage.setItem("deviceId",e),s.data}catch(s){if(console.error("Error en AuthService - login:",((r=s.response)==null?void 0:r.data)||s.message),((n=s.response)==null?void 0:n.status)===403&&((g=(d=(c=s.response)==null?void 0:c.data)==null?void 0:d.error)!=null&&g.includes("Límite de dispositivos")))throw new Error("Has alcanzado el límite de dispositivos conectados. Por favor, cierra sesión en otro dispositivo para continuar.");const v=((p=(l=s.response)==null?void 0:l.data)==null?void 0:p.error)||((u=(h=s.response)==null?void 0:h.data)==null?void 0:u.message)||s.message||"Error desconocido en el servicio de login.";throw new Error(v)}},E=async(t,a)=>{var o,r;const e="/api/auth/register";console.log(`AuthService: Intentando registro para ${t} en ${e}`);try{return(await i.post(e,{username:t,password:a})).data}catch(n){throw console.error("Error en AuthService - register:",((o=n.response)==null?void 0:o.data)||n.message),((r=n.response)==null?void 0:r.data)||new Error(n.message||"Error desconocido en el servicio de registro.")}},f=async(t=!1)=>{var e,o;const a="/api/auth/logout";try{const r=t?null:localStorage.getItem("deviceId");return await i.post(a,{deviceId:r}),localStorage.removeItem("deviceId"),!0}catch(r){throw console.error("Error en AuthService - logout:",((e=r.response)==null?void 0:e.data)||r.message),((o=r.response)==null?void 0:o.data)||new Error(r.message||"Error al cerrar sesión.")}};export{I as login,f as logout,E as register};
